##
# This file is an EasyBuild reciPY as per https://github.com/easybuilders/easybuild
#
# Copyright:: Copyright 2013-2015 Dmitri Gribenko, Ward Poelmans
# Authors:: Dmitri Gribenko <gribozavr@gmail.com>
# Authors:: Ward Poelmans <wpoely86@gmail.com>
# License:: GPLv2 or later, MIT, three-clause BSD.
# $Id$
##

name = 'Clang'
version = '8.0.0'

homepage = 'http://clang.llvm.org/'
description = """C, C++, Objective-C compiler, based on LLVM.  Does not
 include C++ standard library -- use libstdc++ from GCC."""

# Clang also depends on libstdc++ during runtime, but this dependency is
# already specified as the toolchain.
toolchain = {'name': 'GCCcore', 'version': '8.3.0'}
# Do not set optarch to True: it will cause the build to fail
toolchainopts = {'optarch': False}

source_urls = ["http://llvm.org/releases/%(version)s"]
sources = [
    'llvm-%(version)s.src.tar.xz',
    'cfe-%(version)s.src.tar.xz',
    'compiler-rt-%(version)s.src.tar.xz',
    'polly-%(version)s.src.tar.xz',
    'openmp-%(version)s.src.tar.xz',
    # Also include the LLVM linker
    'lld-%(version)s.src.tar.xz',
    'libcxx-%(version)s.src.tar.xz',
    'libcxxabi-%(version)s.src.tar.xz',
]
checksums = [
    '8872be1b12c61450cacc82b3d153eab02be2546ef34fa3580ed14137bb26224c',  # llvm-8.0.0.src.tar.xz
    '084c115aab0084e63b23eee8c233abb6739c399e29966eaeccfc6e088e0b736b',  # cfe-8.0.0.src.tar.xz
    'b435c7474f459e71b2831f1a4e3f1d21203cb9c0172e94e9d9b69f50354f21b1',  # compiler-rt-8.0.0.src.tar.xz
    'e3f5a3d6794ef8233af302c45ceb464b74cdc369c1ac735b6b381b21e4d89df4',  # polly-8.0.0.src.tar.xz
    'f7b1705d2f16c4fc23d6531f67d2dd6fb78a077dd346b02fed64f4b8df65c9d5',  # openmp-8.0.0.src.tar.xz
    '9caec8ec922e32ffa130f0fb08e4c5a242d7e68ce757631e425e9eba2e1a6e37',  # lld-8.0.0.src.tar.xz
    'c2902675e7c84324fb2c1e45489220f250ede016cc3117186785d9dc291f9de2',  # libcxx-8.0.0.src.tar.xz
    'c2d6de9629f7c072ac20ada776374e9e3168142f20a46cdb9d6df973922b07cd',  # libcxxabi-8.0.0.src.tar.xz
]

dependencies = [
    # since Clang is a compiler, binutils is a runtime dependency too
    ('binutils', '2.31.1'),
    ('GMP', '6.1.2'),
]

builddependencies = [
    ('CMake', '3.13.4'),
    ('Python', '2.7.16'),
    ('libxml2', '2.9.8'),
]

assertions = True
usepolly = True
build_lld = True
libcxx = True
enable_rtti = True

skip_all_tests = True

moduleclass = 'compiler'buildstats = [
{
    "build_time": 2614.29,
    "command_line": ['--add-dummy-to-minimal-toolchains', "--buildpath='/dev/shm'", "--configfiles='/cluster/easybuild/config.cfg'", "--containerpath='/cluster/easybuild/containers'", "--filter-deps='adwaita-icon-theme,Autoconf,Autogen,Automake,Autotools,babl,binutils,Bison,byacc,bzip2,cairo,Coreutils,cURL,DBus,dbus-glib,Doxygen,Dyninst,Exiv2,expat,flex,FLTK,fontconfig,fontsproto,freeglut,freetype,FTGL,glibc,glib2,gc,Gdk-Pixbuf,GEGL,gettext,gexiv2,Ghostscript,GL2PS,GLEW,GLib,glproto,GObject-Introspection,GPC,gperfguile,GraphicsMagick,gsettings-desktop-schemas,GTI,GTK+,GtkSourceView,GTS,Guile,HarfBuzz,help2man,hwloc,inputproto,intltool,itstool,JasPer,jhbuild,kbproto,libcroco,libctl,libdap,libdrm,libdwarf,libelf,libepoxy,libevent,libffi,libfontenc,libgd,libgeotiff,libglade,libGLU,libICE,libidn,Libint,libjpeg-turbo,libmypaint,libpciaccess,libpng,libpthread-stubs,libreadline,librsvg,libSM,LibTIFF,libtool,libunistring,libunwind,LibUUID,libX11,libXau,libXaw,libxcb,libXcursor,libXdamage,libXdmcp,libXext,libXfixes,libXfont,libXft,libXi,libXinerama,libxkbcommon,libxml2,libXmu,libXpm,libXrandr,libXrender,libxslt,libXt,libXtst,libyaml,LittleCMS,M4,makedepend,Mesa,motif,ncurses,nettle,numactl,nvidia,Pango,Perl,PCRE,PDT,pixman,pkgconfig,pkg-config,popt,pscom,PyCairo,PyGObject,qt,Qt,Qt5,randrproto,recordproto,renderproto,S-Lang,SQLite,SWIG,Tcl,Tk,texinfo,UDUNITS,util-linux,wget,wxPropertyGrid,wxWidgets,xbitmaps,xcb-proto,xcb-util,xcb-util-image,xcb-util-keysyms,xcb-util-renderutil,xcb-util-wm,xextproto,xineramaproto,X11,XKeyboardConfig,XML-Parser,xorg-macros,XZ,Yasm,YAXT,zlib'", '--group-writable-installdir', "--hide-deps='x264,x265,LAME,g2lib,g2clib,libmatheval'", "--include-easyblocks='/cluster/easybuild/customeasyblocks/*.py'", "--installpath='/cluster/easybuild'", "--job-backend-config='/cluster/easybuild/gc3pie.cfg'", "--job-cores='64'", "--job-max-walltime='5'", "--job-target-resource='nodeshort'", "--module-naming-scheme='CategorizedModuleNamingScheme'", "--module-syntax='Tcl'", "--modules-tool='EnvironmentModulesC'", "--optarch='{\\'dummy\\': \\'march=corei7 -mtune=bdver1\\', \\'GCC\\': \\'march=nehalem -mtune=bdver1\\', \\'Intel\\': \\'msse4.2\\', \\'PGI\\': \\'tp=nehalem\\'}'", "--packagepath='/cluster/easybuild/packages'", "--prefix='/cluster/easybuild'", "--repository='GitRepository'", "--repositorypath='/cluster/easybuild/nehalem/easyconfigs_nehalem.git'", "--robot-paths='/cluster/easybuild/nehalem/easyconfigs_nehalem:'", '--set-gid-bit', "--sourcepath='/cluster/easybuild/sources'", "--subdir-modules='nehalem/modules'", "--subdir-software='nehalem/software'", "--testoutput='/gpfs/fs1/home/meesters/easyconfigs/easybuild-build/Clang-8.0.0-GCCcore-8.3.0'", "--tmpdir='/cluster/easybuild/tmp'", "--umask='002'", '/gpfs/fs1/home/meesters/easyconfigs/Clang-8.0.0-GCCcore-8.2.0.eb'],
    "core_count": 64,
    "cpu_model": "AMD Opteron(TM) Processor 6272",
    "cpu_speed": 2099.915,
    "cpu_vendor": "AMD",
    "easybuild-easyblocks_version": "4.0.1",
    "easybuild-framework_version": "4.0.1",
    "gcc_version": "Using built-in specs.; COLLECT_GCC=gcc; COLLECT_LTO_WRAPPER=/gpfs/fs1/cluster/easybuild/nehalem/software/compiler/GCCcore/8.3.0/bin/../libexec/gcc/x86_64-pc-linux-gnu/8.3.0/lto-wrapper; Target: x86_64-pc-linux-gnu; Configured with: ../configure --enable-languages=c,c++,fortran --enable-lto --enable-checking=release --disable-multilib --enable-shared=yes --enable-static=yes --enable-threads=posix --enable-plugins --enable-gold=default --enable-ld --with-plugin-ld=ld.gold --prefix=/cluster/easybuild/nehalem/software/compiler/GCCcore/8.3.0 --with-local-prefix=/cluster/easybuild/nehalem/software/compiler/GCCcore/8.3.0 --enable-bootstrap --with-isl=/dev/shm/GCCcore/8.3.0/dummy-/gcc-8.3.0/stage2_stuff; Thread model: posix; gcc version 8.3.0 (GCC) ; ",
    "glibc_version": "2.17",
    "hostname": "a0005.mogon",
    "install_size": 2247915048,
    "modules_tool": ('EnvironmentModulesC', '/usr/bin/modulecmd', '3.2.10'),
    "os_name": "centos linux",
    "os_type": "Linux",
    "os_version": "7.6.1810",
    "platform_name": "x86_64-unknown-linux",
    "python_version": "2.7.5 (default, Oct 30 2018, 23:45:53) ; [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]",
    "system_gcc_path": "/cluster/easybuild/nehalem/software/compiler/GCCcore/8.3.0/bin/gcc",
    "system_python_path": "/cluster/easybuild/nehalem/software/lang/Python/2.7.16-GCCcore-8.3.0/bin/python",
    "timestamp": 1573213782,
    "total_memory": 257761,
},
{
    "build_time": 2033.92,
    "command_line": ['--add-dummy-to-minimal-toolchains', "--buildpath='/dev/shm'", "--configfiles='/cluster/easybuild/config.cfg'", "--containerpath='/cluster/easybuild/containers'", "--filter-deps='adwaita-icon-theme,Autoconf,Autogen,Automake,Autotools,babl,binutils,Bison,byacc,bzip2,cairo,Coreutils,cURL,DBus,dbus-glib,Doxygen,Dyninst,Exiv2,expat,flex,FLTK,fontconfig,fontsproto,freeglut,freetype,FTGL,glibc,glib2,gc,Gdk-Pixbuf,GEGL,gettext,gexiv2,Ghostscript,GL2PS,GLEW,GLib,GLPK,glproto,GMP,GObject-Introspection,GPC,gperfguile,GraphicsMagick,gsettings-desktop-schemas,GTI,GTK+,GtkSourceView,GTS,Guile,HarfBuzz,help2man,hwloc,inputproto,intltool,itstool,JasPer,jhbuild,kbproto,libcroco,libctl,libdap,libdrm,libdwarf,libelf,libepoxy,libevent,libffi,libfontenc,libgd,libgeotiff,libglade,libGLU,libICE,libidn,Libint,libjpeg-turbo,libmypaint,libpciaccess,libpng,libpthread-stubs,libreadline,librsvg,libSM,LibTIFF,libtool,libunistring,libunwind,LibUUID,libX11,libXau,libXaw,libxcb,libXcursor,libXdamage,libXdmcp,libXext,libXfixes,libXfont,libXft,libXi,libXinerama,libxkbcommon,libxml2,libXmu,libXpm,libXrandr,libXrender,libxslt,libXt,libXtst,libyaml,LittleCMS,M4,makedepend,Mesa,motif,NASM,ncurses,nettle,numactl,nvidia,PCRE,PDT,pixman,pkgconfig,pkg-config,popt,PROJ,pscom,PyCairo,PyGObject,qt,Qt,Qt5,randrproto,recordproto,renderproto,S-Lang,SQLite,SWIG,Tcl,texinfo,Tk,UDUNITS,util-linux,wxPropertyGrid,xbitmaps,xcb-proto,xcb-util,xcb-util-image,xcb-util-keysyms,xcb-util-renderutil,xcb-util-wm,xextproto,xineramaproto,X11,XKeyboardConfig,XML-Parser,xorg-macros,XZ,Yasm,YAXT,zlib'", '--group-writable-installdir', "--hide-deps='x264,x265,LAME,g2lib,g2clib,libmatheval'", "--include-easyblocks='/cluster/easybuild/customeasyblocks/*.py'", "--installpath='/cluster/easybuild'", "--job-backend-config='/cluster/easybuild/gc3pie.cfg'", "--job-cores='40'", "--job-max-walltime='5'", "--job-target-resource='parallel'", '--minimal-toolchains', "--module-naming-scheme='CategorizedModuleNamingScheme'", "--module-syntax='Tcl'", "--modules-tool='EnvironmentModulesC'", "--optarch='{\\'dummy\\': \\'march=core-avx2\\', \\'GCC\\': \\'march=broadwell -mtune=broadwell\\', \\'Intel\\': \\'xCORE-AVX2\\', \\'PGI\\': \\'tp=haswell\\'}'", "--packagepath='/cluster/easybuild/packages'", "--parallel='40'", "--prefix='/cluster/easybuild'", "--repository='GitRepository'", "--repositorypath='/cluster/easybuild/broadwell/easyconfigs_broadwell.git'", "--robot-paths='/cluster/easybuild/broadwell/easyconfigs_broadwell:'", '--set-gid-bit', "--sourcepath='/cluster/easybuild/sources'", "--subdir-modules='broadwell/modules'", "--subdir-software='broadwell/software'", "--testoutput='/gpfs/fs1/home/meesters/easyconfigs/easybuild-build/Clang-8.0.0-GCCcore-8.3.0'", "--tmpdir='/cluster/easybuild/tmp'", "--umask='002'", '/gpfs/fs1/cluster/easybuild/nehalem/easyconfigs_nehalem/Clang/Clang-8.0.0-GCCcore-8.3.0.eb'],
    "core_count": 40,
    "cpu_model": "Intel(R) Xeon(R) CPU E5-2630 v4 @ 2.20GHz",
    "cpu_speed": 2201.0,
    "cpu_vendor": "Intel",
    "easybuild-easyblocks_version": "4.0.1",
    "easybuild-framework_version": "4.0.1",
    "gcc_version": "Using built-in specs.; COLLECT_GCC=gcc; COLLECT_LTO_WRAPPER=/cluster/easybuild/broadwell/software/compiler/GCCcore/8.3.0/libexec/gcc/x86_64-pc-linux-gnu/8.3.0/lto-wrapper; Target: x86_64-pc-linux-gnu; Configured with: ../configure --enable-languages=c,c++,fortran --enable-lto --enable-checking=release --disable-multilib --enable-shared=yes --enable-static=yes --enable-threads=posix --enable-plugins --enable-gold=default --enable-ld --with-plugin-ld=ld.gold --prefix=/cluster/easybuild/broadwell/software/compiler/GCCcore/8.3.0 --with-local-prefix=/cluster/easybuild/broadwell/software/compiler/GCCcore/8.3.0 --enable-bootstrap --with-isl=/dev/shm/GCCcore/8.3.0/dummy-/gcc-8.3.0/stage2_stuff; Thread model: posix; gcc version 8.3.0 (GCC) ; ",
    "glibc_version": "2.17",
    "hostname": "z0575.mogonii",
    "install_size": 2247914214,
    "modules_tool": ('EnvironmentModulesC', '/usr/bin/modulecmd', '3.2.10'),
    "os_name": "centos linux",
    "os_type": "Linux",
    "os_version": "7.6.1810",
    "platform_name": "x86_64-unknown-linux",
    "python_version": "2.7.5 (default, Oct 30 2018, 23:45:53) ; [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]",
    "system_gcc_path": "/cluster/easybuild/broadwell/software/compiler/GCCcore/8.3.0/bin/gcc",
    "system_python_path": "/cluster/easybuild/broadwell/software/lang/Python/2.7.16-GCCcore-8.3.0/bin/python",
    "timestamp": 1573221575,
    "total_memory": 64307,
},
]
